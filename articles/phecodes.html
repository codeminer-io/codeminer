<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Phecodes • codeminer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phecodes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">codeminer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/codeminer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/caliber.html">CALIBER code lists</a></li>
    <li><a class="dropdown-item" href="../articles/icd10_formats.html">ICD10 code formats</a></li>
    <li><a class="dropdown-item" href="../articles/MAP.html">Mapping between clinical coding systems</a></li>
    <li><a class="dropdown-item" href="../articles/phecodes.html">Phecodes</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/codeminer-io/codeminer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Phecodes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/codeminer-io/codeminer/blob/main/vignettes/phecodes.Rmd" class="external-link"><code>vignettes/phecodes.Rmd</code></a></small>
      <div class="d-none name"><code>phecodes.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/codeminer-io/codeminer" class="external-link">codeminer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">all_lkps_maps_dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_all_lkps_maps_dummy.html">build_all_lkps_maps_dummy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A phenome-wide association study analyses associations between a
single genetic (or non-genetic) exposure across a number of phenotypes.
One way to perform this is by using phecodes.<span class="citation">(Denny, Bastarache, and Roden 2016; Wu et al.
2019)</span></p>
<p>This vignette outlines one approach for mapping UK Biobank clinical
codes to phecodes.</p>
</div>
<div class="section level2">
<h2 id="map-uk-biobank-clinical-events-to-phecodes">Map UK Biobank clinical events to phecodes<a class="anchor" aria-label="anchor" href="#map-uk-biobank-clinical-events-to-phecodes"></a>
</h2>
<p>A UK Biobank clinical events table created by
<code><a href="https://rmgpanw.github.io/ukbwranglr/reference/tidy_clinical_events.html" class="external-link">ukbwranglr::tidy_clinical_events()</a></code> may be mapped to
Phecodes using <code><a href="../reference/map_clinical_events_to_phecodes.html">map_clinical_events_to_phecodes()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dummy clinical events data frame</span></span>
<span><span class="va">dummy_clinical_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dummy_clinical_events_tidy.html">dummy_clinical_events_tidy</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># map to Phecodes</span></span>
<span><span class="va">dummy_clinical_events_phecodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_clinical_events_to_phecodes.html">map_clinical_events_to_phecodes</a></span><span class="op">(</span>clinical_events <span class="op">=</span> <span class="va">dummy_clinical_events</span>,</span>
<span>                                                            all_lkps_maps <span class="op">=</span> <span class="va">all_lkps_maps_dummy</span>,</span>
<span>                                                            min_date_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Identified the following 5 data sources to map to phecodes: [1] **Death register** - Underlying (primary) cause of death, [2] **Death register** - Contributory (secondary) cause of death, [3] **Primary care** - `read_2` column, data provider England (Vision), [4] **Primary care** - `read_3` column, data provider England (TPP), [5] **Summary Diagnoses - Hospital inpatient - Health-related outcomes** - Diagnoses - ICD9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***MAPPING clinical_events TO PHECODES***</span></span>
<span><span class="co">#&gt; [1] **Death register** - Underlying (primary) cause of death</span></span>
<span><span class="co">#&gt; [2] **Death register** - Contributory (secondary) cause of death</span></span>
<span><span class="co">#&gt; [3] **Primary care** - `read_2` column, data provider England (Vision)</span></span>
<span><span class="co">#&gt; [4] **Primary care** - `read_3` column, data provider England (TPP)</span></span>
<span><span class="co">#&gt; [5] **Summary Diagnoses - Hospital inpatient - Health-related outcomes** - Diagnoses - ICD9</span></span>
<span><span class="co">#&gt; Time taken: 0 minutes, 0 seconds.</span></span>
<span></span>
<span><span class="va">dummy_clinical_events_phecodes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;     eid source  index code  date       icd10 phecode</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 f40001  0_0   <span style="color: #BB0000;">NA</span>    1917-10-08 I10   401.1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 f40002  0_0   <span style="color: #BB0000;">NA</span>    1955-02-11 E109  250.1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1 gpc3_r3 3     XaIP9 1917-10-08 L721  706.2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1 gpc3_r3 3     XaIP9 1917-10-08 L721  704    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1 gpc3_r3 3     XE0Uc 1917-10-08 I10   401.1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1 f41271  0_0   4019  1910-02-19 I10   401.1</span></span></code></pre></div>
<p>ICD10 codes are mapped directly to phecodes, while non-ICD10 sources
are mapped to phecodes via ICD10. Use the <code>col_filters</code>
argument to determine which code mappings to include (see
<code>vignette(map_codes)</code> for further details).</p>
<p>The following data sources (if present in the clinical events data
frame) are included in the mapping:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="8%">
<col width="32%">
<col width="43%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">source</th>
<th align="left">data_coding</th>
<th align="left">description</th>
<th align="left">category</th>
<th align="left">file</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">f40001</td>
<td align="left">icd10</td>
<td align="left">Underlying (primary) cause of death</td>
<td align="left">Death register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f40002</td>
<td align="left">icd10</td>
<td align="left">Contributory (secondary) cause of death</td>
<td align="left">Death register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f20002_icd10</td>
<td align="left">icd10</td>
<td align="left">Non-cancer illness code, self-reported</td>
<td align="left">Medical conditions</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f40013</td>
<td align="left">icd9</td>
<td align="left">Type of cancer: ICD9</td>
<td align="left">Cancer register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f40006</td>
<td align="left">icd10</td>
<td align="left">Type of cancer: ICD10</td>
<td align="left">Cancer register</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">f41270</td>
<td align="left">icd10</td>
<td align="left">Diagnoses - ICD10</td>
<td align="left">Summary Diagnoses - Hospital inpatient - Health-related
outcomes</td>
<td align="left">ukb_main</td>
</tr>
<tr class="odd">
<td align="left">f41271</td>
<td align="left">icd9</td>
<td align="left">Diagnoses - ICD9</td>
<td align="left">Summary Diagnoses - Hospital inpatient - Health-related
outcomes</td>
<td align="left">ukb_main</td>
</tr>
<tr class="even">
<td align="left">gpc1_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider England
(Vision)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc2_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider Scotland</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="even">
<td align="left">gpc4_r2</td>
<td align="left">read2</td>
<td align="left">
<code>read_2</code> column, data provider Wales</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
<tr class="odd">
<td align="left">gpc3_r3</td>
<td align="left">read3</td>
<td align="left">
<code>read_3</code> column, data provider England
(TPP)</td>
<td align="left">Primary care</td>
<td align="left">gp_clinical</td>
</tr>
</tbody>
</table>
<p>The the output from <code><a href="../reference/map_clinical_events_to_phecodes.html">map_clinical_events_to_phecodes()</a></code>
may be reformatted for running a phenome-wide association study using
the <a href="https://github.com/PheWAS/PheWAS" class="external-link">PheWAS package</a> as
follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy_clinical_events_phecodes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">eid</span>,</span>
<span>                      <span class="va">phecode</span>,</span>
<span>                      <span class="va">date</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>               <span class="co"># ensure one phecode only per eid</span></span>
<span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>               <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">phecode</span>,</span>
<span>                           values_from <span class="op">=</span> <span class="va">date</span>,</span>
<span>                           values_fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;     eid `401.1` `250.1` `706.2` `704`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 TRUE    TRUE    TRUE    TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reverse-mapping">Reverse mapping<a class="anchor" aria-label="anchor" href="#reverse-mapping"></a>
</h2>
<p>Ideally all Read and ICD9 code to phecode mappings should be manually
checked prior to their use. At the very least, any findings of interest
should be manually reviewed to ascertain exactly which clinical codes
were used. Use <code><a href="../reference/make_phecode_reverse_map.html">make_phecode_reverse_map()</a></code> to achieve
this</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make_phecode_reverse_map.html">make_phecode_reverse_map</a></span><span class="op">(</span>clinical_events_phecodes <span class="op">=</span> <span class="va">dummy_clinical_events_phecodes</span>,</span>
<span>                           all_lkps_maps <span class="op">=</span> <span class="va">all_lkps_maps_dummy</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time taken: 0 minutes, 0 seconds.</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="20%">
<col width="6%">
<col width="3%">
<col width="27%">
<col width="9%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left">phecode</th>
<th align="left">phecode_description</th>
<th align="left">data_coding</th>
<th align="left">code</th>
<th align="left">description</th>
<th align="left">icd10_equivalent</th>
<th align="left">icd10_description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">icd10</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
<tr class="even">
<td align="left">250.1</td>
<td align="left">Type 1 diabetes</td>
<td align="left">icd10</td>
<td align="left">E109</td>
<td align="left">Type 1 diabetes mellitus Without complications</td>
<td align="left">E109</td>
<td align="left">Type 1 diabetes mellitus Without complications</td>
</tr>
<tr class="odd">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">icd9</td>
<td align="left">4019</td>
<td align="left">ESSENTIAL HYPERTENSION NOT SPECIFIED</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
<tr class="even">
<td align="left">706.2</td>
<td align="left">Sebaceous cyst</td>
<td align="left">read3</td>
<td align="left">XaIP9</td>
<td align="left">Sebaceous cyst</td>
<td align="left">L721</td>
<td align="left">Trichilemmal cyst</td>
</tr>
<tr class="odd">
<td align="left">704</td>
<td align="left">Diseases of hair and hair follicles</td>
<td align="left">read3</td>
<td align="left">XaIP9</td>
<td align="left">Sebaceous cyst</td>
<td align="left">L721</td>
<td align="left">Trichilemmal cyst</td>
</tr>
<tr class="even">
<td align="left">401.1</td>
<td align="left">Essential hypertension</td>
<td align="left">read3</td>
<td align="left">XE0Uc</td>
<td align="left">Essential hypertension</td>
<td align="left">I10</td>
<td align="left">Essential (primary) hypertension</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-denny2016" class="csl-entry">
Denny, Joshua C., Lisa Bastarache, and Dan M. Roden. 2016.
<span>“Phenome-Wide Association Studies as a Tool to Advance Precision
Medicine.”</span> <em>Annual Review of Genomics and Human Genetics</em>
17 (August): 353–73. <a href="https://doi.org/10.1146/annurev-genom-090314-024956" class="external-link">https://doi.org/10.1146/annurev-genom-090314-024956</a>.
</div>
<div id="ref-wu2019" class="csl-entry">
Wu, Patrick, Aliya Gifford, Xiangrui Meng, Xue Li, Harry Campbell, Tim
Varley, Juan Zhao, et al. 2019. <span>“Mapping ICD-10 and ICD-10-CM
Codes to Phecodes: Workflow Development and Initial Evaluation.”</span>
<em>JMIR medical informatics</em> 7 (4): e14325. <a href="https://doi.org/10.2196/14325" class="external-link">https://doi.org/10.2196/14325</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alasdair Warwick.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
